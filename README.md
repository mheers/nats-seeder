# nats-seeder

> Creates seeds for nats operators and accounts

## Howto build

```bash
docker build -t mheers/nats-seeder .
docker push mheers/nats-seeder
```

## Usage

### Seeds

```bash
nats-seeder seeds
```

results in

```
OPERATOR_SEED="SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M"
SYS_ACCOUNT_SEED="SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E"
ACCOUNT_SEED="SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE"
```

### Operator

Create the public key:

```bash
nast-seeder operator-public-key \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE
```

gives `ODDCMHMPYKIACJP7WJ5WUBPZFHMW4MADOOUDLNTXX6LJZDYHO5EQELFD`

Create the jwt:

```bash
nast-seeder operator-jwt \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE
```

gives `eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiJVWFBOUUdXTjZFV1FIRVU2UzZMVlRBWVdTQkpXVUZHVE9aUzQ2VVUzTjRWQ0ZOQklHSEFRIiwiaWF0IjoxNjMyMzgwODIyLCJpc3MiOiJPRERDTUhNUFlLSUFDSlA3V0o1V1VCUFpGSE1XNE1BRE9PVURMTlRYWDZMSlpEWUhPNUVRRUxGRCIsInN1YiI6Ik9ERENNSE1QWUtJQUNKUDdXSjVXVUJQWkZITVc0TUFET09VRExOVFhYNkxKWkRZSE81RVFFTEZEIiwibmF0cyI6eyJ0eXBlIjoib3BlcmF0b3IiLCJ2ZXJzaW9uIjoyfX0.6AFKk_uzifvPaRtVAunllxxUx0mOYnIeUB6N9u1vL9wOcn1ml5UF2wOfMugiJ8NWvXhNnu50euaLPw20EL8UDQ`

### System-Account

Create the public key:

```bash
nast-seeder sys-account-public-key \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE
```

gives `ADPF746QXTAOIJMMCC6MPCROLETNI2GDR7RDKWG3WOY6UOVG6O4JQV2Q`

Create the jwt:

```bash
nast-seeder sys-account-jwt \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE
```

gives `eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiJGSFFWVU5NWjU2UFNKM0xNNjM2WVBEM05MREpQRFdJVzVCT1NEV0NOS1hCVFpBWlpMWkJRIiwiaWF0IjoxNjMyMzgxMDI4LCJpc3MiOiJPRERDTUhNUFlLSUFDSlA3V0o1V1VCUFpGSE1XNE1BRE9PVURMTlRYWDZMSlpEWUhPNUVRRUxGRCIsInN1YiI6IkFEUEY3NDZRWFRBT0lKTU1DQzZNUENST0xFVE5JMkdEUjdSREtXRzNXT1k2VU9WRzZPNEpRVjJRIiwibmF0cyI6eyJsaW1pdHMiOnsic3VicyI6LTEsImRhdGEiOi0xLCJwYXlsb2FkIjotMSwiaW1wb3J0cyI6LTEsImV4cG9ydHMiOi0xLCJ3aWxkY2FyZHMiOnRydWUsImNvbm4iOi0xLCJsZWFmIjotMX0sImRlZmF1bHRfcGVybWlzc2lvbnMiOnsicHViIjp7fSwic3ViIjp7fX0sInR5cGUiOiJhY2NvdW50IiwidmVyc2lvbiI6Mn19.ciJPMefUeFh0AlkubncJGOz1sBxsoolsyAQqZn-uaD55ytCqFx6BvXshBhNgNvMF14zC98qXIhUuHjC1lyVHBQ`

### Account

Create the public key:

```bash
nast-seeder account-public-key \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE
```

gives `ADCCABGKVTMJWVLCXAYMXPNTNFW4WUQAD2BVJEWJ36Y2GS4Y3VOVLO65`

Create the jwt:

```bash
nast-seeder account-jwt \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE
```

gives `eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiI2TEVHSzRSUjVOVU9JTlZERkdZQk4zN0JRQU40NUFCRlFKV0wzQlgzSFA0S1pXRTQ1TFhRIiwiaWF0IjoxNjMyMzgwOTgxLCJpc3MiOiJPRERDTUhNUFlLSUFDSlA3V0o1V1VCUFpGSE1XNE1BRE9PVURMTlRYWDZMSlpEWUhPNUVRRUxGRCIsInN1YiI6IkFEQ0NBQkdLVlRNSldWTENYQVlNWFBOVE5GVzRXVVFBRDJCVkpFV0ozNlkyR1M0WTNWT1ZMTzY1IiwibmF0cyI6eyJsaW1pdHMiOnsic3VicyI6LTEsImRhdGEiOi0xLCJwYXlsb2FkIjotMSwiaW1wb3J0cyI6LTEsImV4cG9ydHMiOi0xLCJ3aWxkY2FyZHMiOnRydWUsImNvbm4iOi0xLCJsZWFmIjotMSwibWVtX3N0b3JhZ2UiOjEwNzM3NDE4MjQsImRpc2tfc3RvcmFnZSI6MTA3Mzc0MTgyNCwic3RyZWFtcyI6MTAsImNvbnN1bWVyIjoxMH0sImRlZmF1bHRfcGVybWlzc2lvbnMiOnsicHViIjp7fSwic3ViIjp7fX0sInR5cGUiOiJhY2NvdW50IiwidmVyc2lvbiI6Mn19.6f9_qaY2tQwELlL5cD2lsJsX2jiZ0Vne-VJl_uI2EnwzIHCbOk1cFsEBB3QRu1XsVSl801xv_97ocJlfRMiiBg`

### Create the server.conf

Putting it all together could look like

```
port: 4222

# Operator "memory"
operator: eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiJVWFBOUUdXTjZFV1FIRVU2UzZMVlRBWVdTQkpXVUZHVE9aUzQ2VVUzTjRWQ0ZOQklHSEFRIiwiaWF0IjoxNjMyMzgwODIyLCJpc3MiOiJPRERDTUhNUFlLSUFDSlA3V0o1V1VCUFpGSE1XNE1BRE9PVURMTlRYWDZMSlpEWUhPNUVRRUxGRCIsInN1YiI6Ik9ERENNSE1QWUtJQUNKUDdXSjVXVUJQWkZITVc0TUFET09VRExOVFhYNkxKWkRZSE81RVFFTEZEIiwibmF0cyI6eyJ0eXBlIjoib3BlcmF0b3IiLCJ2ZXJzaW9uIjoyfX0.6AFKk_uzifvPaRtVAunllxxUx0mOYnIeUB6N9u1vL9wOcn1ml5UF2wOfMugiJ8NWvXhNnu50euaLPw20EL8UDQ

resolver: MEMORY
resolver_preload: {
  ADPF746QXTAOIJMMCC6MPCROLETNI2GDR7RDKWG3WOY6UOVG6O4JQV2Q: "eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiJGSFFWVU5NWjU2UFNKM0xNNjM2WVBEM05MREpQRFdJVzVCT1NEV0NOS1hCVFpBWlpMWkJRIiwiaWF0IjoxNjMyMzgxMDI4LCJpc3MiOiJPRERDTUhNUFlLSUFDSlA3V0o1V1VCUFpGSE1XNE1BRE9PVURMTlRYWDZMSlpEWUhPNUVRRUxGRCIsInN1YiI6IkFEUEY3NDZRWFRBT0lKTU1DQzZNUENST0xFVE5JMkdEUjdSREtXRzNXT1k2VU9WRzZPNEpRVjJRIiwibmF0cyI6eyJsaW1pdHMiOnsic3VicyI6LTEsImRhdGEiOi0xLCJwYXlsb2FkIjotMSwiaW1wb3J0cyI6LTEsImV4cG9ydHMiOi0xLCJ3aWxkY2FyZHMiOnRydWUsImNvbm4iOi0xLCJsZWFmIjotMX0sImRlZmF1bHRfcGVybWlzc2lvbnMiOnsicHViIjp7fSwic3ViIjp7fX0sInR5cGUiOiJhY2NvdW50IiwidmVyc2lvbiI6Mn19.ciJPMefUeFh0AlkubncJGOz1sBxsoolsyAQqZn-uaD55ytCqFx6BvXshBhNgNvMF14zC98qXIhUuHjC1lyVHBQ"
  ADCCABGKVTMJWVLCXAYMXPNTNFW4WUQAD2BVJEWJ36Y2GS4Y3VOVLO65: "eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiI2TEVHSzRSUjVOVU9JTlZERkdZQk4zN0JRQU40NUFCRlFKV0wzQlgzSFA0S1pXRTQ1TFhRIiwiaWF0IjoxNjMyMzgwOTgxLCJpc3MiOiJPRERDTUhNUFlLSUFDSlA3V0o1V1VCUFpGSE1XNE1BRE9PVURMTlRYWDZMSlpEWUhPNUVRRUxGRCIsInN1YiI6IkFEQ0NBQkdLVlRNSldWTENYQVlNWFBOVE5GVzRXVVFBRDJCVkpFV0ozNlkyR1M0WTNWT1ZMTzY1IiwibmF0cyI6eyJsaW1pdHMiOnsic3VicyI6LTEsImRhdGEiOi0xLCJwYXlsb2FkIjotMSwiaW1wb3J0cyI6LTEsImV4cG9ydHMiOi0xLCJ3aWxkY2FyZHMiOnRydWUsImNvbm4iOi0xLCJsZWFmIjotMSwibWVtX3N0b3JhZ2UiOjEwNzM3NDE4MjQsImRpc2tfc3RvcmFnZSI6MTA3Mzc0MTgyNCwic3RyZWFtcyI6MTAsImNvbnN1bWVyIjoxMH0sImRlZmF1bHRfcGVybWlzc2lvbnMiOnsicHViIjp7fSwic3ViIjp7fX0sInR5cGUiOiJhY2NvdW50IiwidmVyc2lvbiI6Mn19.6f9_qaY2tQwELlL5cD2lsJsX2jiZ0Vne-VJl_uI2EnwzIHCbOk1cFsEBB3QRu1XsVSl801xv_97ocJlfRMiiBg"
}
system_account: ADPF746QXTAOIJMMCC6MPCROLETNI2GDR7RDKWG3WOY6UOVG6O4JQV2Q

debug:   true
trace:   true

jetstream {
   store_dir=data
}
```

### Create a user (test credentials)

```bash
nats-seeder user-nkey \
    --operator-seed SOAON2QVZ5L7CMOO5W3PV4F7OCDU7L6AXIO5VA2YWIBTTSLUN64UNOU63M \
    --sys-account-seed SAABOFAWXZYMP3LWVULJTFD25YDFA5UEJ4FRIELRRIHQNMSQFDWKLNXS5E \
    --account-seed SAADBIEN2MTECGRQDK3Y6XHK7PADDSXR6SOCQOM5GFORHLBAX6V6C65OOE \
    -u test \
    -p "\$JS.API.>" -s "\$JS.API.>" -p "_INBOX.>" -s "_INBOX.>" \
    > test.creds
```

gives a `test.creds` with

```
-----BEGIN NATS USER JWT-----
eyJ0eXAiOiJKV1QiLCJhbGciOiJlZDI1NTE5LW5rZXkifQ.eyJqdGkiOiI3QVJKSldBS1VXQUEyNDZTSUJGREY3N1VVV001UDNNWlFENTRWMldFNFdBMzJTSzZBSUhRIiwiaWF0IjoxNjMyMzgxNDUwLCJpc3MiOiJBRENDQUJHS1ZUTUpXVkxDWEFZTVhQTlRORlc0V1VRQUQyQlZKRVdKMzZZMkdTNFkzVk9WTE82NSIsIm5hbWUiOiJ0ZXN0Iiwic3ViIjoiVUNBT0hZNVVXU040WEoyVjVWNEpVU09IQVpPSU02Q0czVEpUS0QyQ1BYQzdNUjVYNVdUSkdBSkciLCJuYXRzIjp7InB1YiI6eyJhbGxvdyI6WyIkSlMuQVBJLlx1MDAzZSIsIl9JTkJPWC5cdTAwM2UiXX0sInN1YiI6eyJhbGxvdyI6WyIkSlMuQVBJLlx1MDAzZSIsIl9JTkJPWC5cdTAwM2UiXX0sInN1YnMiOi0xLCJkYXRhIjotMSwicGF5bG9hZCI6LTEsImJlYXJlcl90b2tlbiI6dHJ1ZSwidHlwZSI6InVzZXIiLCJ2ZXJzaW9uIjoyfX0._u0oDVpIDgZ8gWehEdmsA659N764mfXmF-Mz08W1tyujgOCTCRT-IBtob5TqpQPVMpV_kZ-8x0-Gl0ROM0SODg
-----END NATS USER JWT-----

-----BEGIN USER NKEY SEED-----
SUAJJAENTMXF37GR6VO2XONACRRERJRMQQVZUXSPY5NWGWASZ56GSPN54Q
-----END USER NKEY SEED-----
```
